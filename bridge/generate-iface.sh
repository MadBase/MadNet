#! /bin/bash
set -euo pipefail

cd bindings

output="package bindings"

for f in ./bindings-artifacts/*.json; do
	contract=$(basename $f .json)
	
	echo "generating $contract interface..."
	ifacemaker -f ${contract}.go -s ${contract}Caller -o ${contract}.iface.c.go -p bindings -i I${contract}Caller -c "Generated by ifacemaker. DO NOT EDIT."
	ifacemaker -f ${contract}.go -s ${contract}Transactor -o ${contract}.iface.t.go -p bindings -i I${contract}Transactor -c "Generated by ifacemaker. DO NOT EDIT."
	ifacemaker -f ${contract}.go -s ${contract}Filterer -o ${contract}.iface.f.go -p bindings -i I${contract}Filterer -c "Generated by ifacemaker. DO NOT EDIT." 
 
	output="${output}

type I${contract} interface {
	I${contract}Caller
	I${contract}Transactor
	I${contract}Filterer
}"
done

echo "$output" > ./iface.go